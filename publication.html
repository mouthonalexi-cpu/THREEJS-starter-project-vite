<!doctype html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Produit</title>
  <link rel="stylesheet" href="/site.css">

</head>
<body>

  <header class="nav">
    <div class="container nav-inner">
      <a class="brand" href="/index.html" aria-label="AM Composit">
  <img src="/Images/Logos/AM_LOGO_ONLY_WHITE_CLEAN - Copie1.png" alt="AM Composit" class="brand-logo">
</a>

      <nav class="nav-links">
        <a href="/produit.html">Produit</a>
        <a href="/boutique.html">Boutique</a>
        

      </nav>
    </div>
  </header>

  <main class="container publications">
    <div class="page-head">
      <h1 class="page-title">Publications</h1>
      <p class="page-subtitle">Clique sur une image pour l’ouvrir en plein écran.</p>
    </div>

    <!-- Grille Pinterest -->
    <div class="pub-grid" id="pubGrid"></div>
  </main>

  <!-- Viewer plein écran (Google Images style) -->
  <div class="viewer" id="viewer" aria-hidden="true">
    <div class="viewer-top">
      <div class="viewer-left">
        <button class="viewer-btn" id="vClose" aria-label="Fermer">✕</button>
        <div class="viewer-counter" id="vCounter">1 / 1</div>
      </div>

      <div class="viewer-right">
        <button class="viewer-btn" id="vZoomOut" aria-label="Zoom -">−</button>
        <button class="viewer-btn" id="vZoomReset" aria-label="Reset zoom">100%</button>
        <button class="viewer-btn" id="vZoomIn" aria-label="Zoom +">+</button>
        <a class="viewer-btn" id="vOpen" href="#" target="_blank" rel="noopener" aria-label="Ouvrir l'image">↗</a>
      </div>
    </div>

    <button class="viewer-nav prev" id="vPrev" aria-label="Précédent">‹</button>
    <button class="viewer-nav next" id="vNext" aria-label="Suivant">›</button>

    <div class="viewer-stage" id="vStage">
      <img id="vImg" alt="" draggable="false">
    </div>

    <div class="viewer-caption" id="vCaption"></div>
  </div>

  <script>
    // ✅ Mets tes noms de fichiers ici (plus simple que dupliquer 50 blocs HTML)
  const items = [
  { src: "/public.jpg", caption: "TEst 1" },
  
];

    
    ;

    const grid = document.getElementById("pubGrid");

    // Build grid
    items.forEach((it, i) => {
      const a = document.createElement("a");
      a.className = "pub-item";
      a.href = it.src;
      a.setAttribute("data-index", String(i));
      a.setAttribute("data-caption", it.caption || "");

      const img = document.createElement("img");
      img.loading = "lazy";
      img.src = it.src;
      img.alt = it.caption || "";

      a.appendChild(img);
      grid.appendChild(a);
    });

    // Viewer logic
    const viewer = document.getElementById("viewer");
    const vImg = document.getElementById("vImg");
    const vStage = document.getElementById("vStage");
    const vCaption = document.getElementById("vCaption");
    const vCounter = document.getElementById("vCounter");
    const vOpen = document.getElementById("vOpen");

    const vClose = document.getElementById("vClose");
    const vPrev = document.getElementById("vPrev");
    const vNext = document.getElementById("vNext");
    const vZoomIn = document.getElementById("vZoomIn");
    const vZoomOut = document.getElementById("vZoomOut");
    const vZoomReset = document.getElementById("vZoomReset");

    let current = 0;
    let scale = 1, tx = 0, ty = 0;
    let dragging = false, startX = 0, startY = 0, startTx = 0, startTy = 0;
    let touchStartX = 0, touchStartY = 0;

    function clamp(n, min, max){ return Math.max(min, Math.min(max, n)); }

    function applyTransform(){
      const maxPanX = (scale - 1) * (window.innerWidth * 0.25);
      const maxPanY = (scale - 1) * (window.innerHeight * 0.25);
      tx = clamp(tx, -maxPanX, maxPanX);
      ty = clamp(ty, -maxPanY, maxPanY);
      vImg.style.transform = `translate3d(${tx}px, ${ty}px, 0) scale(${scale})`;
      vZoomReset.textContent = `${Math.round(scale * 100)}%`;
    }

    function resetView(){ scale = 1; tx = 0; ty = 0; applyTransform(); }

    function openAt(index){
      current = (index + items.length) % items.length;
      const it = items[current];

      vImg.src = it.src;
      vImg.alt = it.caption || "";
      vCaption.textContent = it.caption || "";
      vOpen.href = it.src;
      vCounter.textContent = `${current + 1} / ${items.length}`;

      resetView();
      viewer.classList.add("is-open");
      viewer.setAttribute("aria-hidden", "false");
      document.body.style.overflow = "hidden";
    }

    function closeViewer(){
      viewer.classList.remove("is-open");
      viewer.setAttribute("aria-hidden", "true");
      document.body.style.overflow = "";
      vImg.src = "";
    }

    function next(){ openAt(current + 1); }
    function prev(){ openAt(current - 1); }

    // Open on click
    grid.addEventListener("click", (e) => {
      const item = e.target.closest(".pub-item");
      if (!item) return;
      e.preventDefault();
      openAt(Number(item.getAttribute("data-index") || "0"));
    });

    // Buttons
    vClose.addEventListener("click", closeViewer);
    vNext.addEventListener("click", next);
    vPrev.addEventListener("click", prev);

    // Close if click outside image
    viewer.addEventListener("click", (e) => {
      if (e.target === viewer) closeViewer();
    });

    // Keyboard
    window.addEventListener("keydown", (e) => {
      if (!viewer.classList.contains("is-open")) return;
      if (e.key === "Escape") closeViewer();
      if (e.key === "ArrowRight") next();
      if (e.key === "ArrowLeft") prev();
    });

    // Zoom buttons
    vZoomIn.addEventListener("click", () => { scale = clamp(scale * 1.2, 1, 6); applyTransform(); });
    vZoomOut.addEventListener("click", () => { scale = clamp(scale / 1.2, 1, 6); applyTransform(); });
    vZoomReset.addEventListener("click", resetView);

    // Wheel zoom
    vStage.addEventListener("wheel", (e) => {
      if (!viewer.classList.contains("is-open")) return;
      e.preventDefault();
      const factor = e.deltaY < 0 ? 1.12 : (1/1.12);
      scale = clamp(scale * factor, 1, 6);
      applyTransform();
    }, { passive: false });

    // Drag (only when zoomed)
    vStage.addEventListener("pointerdown", (e) => {
      if (scale <= 1) return;
      dragging = true;
      vImg.classList.add("dragging");
      startX = e.clientX; startY = e.clientY;
      startTx = tx; startTy = ty;
      vStage.setPointerCapture(e.pointerId);
    });

    vStage.addEventListener("pointermove", (e) => {
      if (!dragging) return;
      tx = startTx + (e.clientX - startX);
      ty = startTy + (e.clientY - startY);
      applyTransform();
    });

    vStage.addEventListener("pointerup", () => {
      dragging = false;
      vImg.classList.remove("dragging");
    });

    // Mobile swipe (when not zoomed)
    vStage.addEventListener("touchstart", (e) => {
      if (scale > 1) return;
      if (!e.touches || e.touches.length !== 1) return;
      touchStartX = e.touches[0].clientX;
      touchStartY = e.touches[0].clientY;
    }, { passive: true });

    vStage.addEventListener("touchend", (e) => {
      if (scale > 1) return;
      const t = e.changedTouches?.[0];
      if (!t) return;
      const dx = t.clientX - touchStartX;
      const dy = t.clientY - touchStartY;
      if (Math.abs(dx) > 50 && Math.abs(dx) > Math.abs(dy)) (dx < 0) ? next() : prev();
    }, { passive: true });
  </script>
</body>
</html>

<footer class="footer">
    <div class="container">
      © <span id="y"></span> AM Composit — tous droits réservé • Contact : info@amcomposit.ch
    </div>
  </footer>

  <script>
    document.getElementById("y").textContent = new Date().getFullYear();
  </script>
</body>
</html>
